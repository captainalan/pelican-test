<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>Arch Linux Install for n00bs</title>
        <link rel="stylesheet" href="https://captainalan.github.io/pelican-test/theme/css/main.css" />
        <link href="https://captainalan.github.io/pelican-test/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Alan's Miscellaneous Stuff Blog Atom Feed" />
        <meta name="description" content="(Last updated February 14, 2021) In this tutorial, I will go through installing Arch Linux. These instructions were tried out on both a virtual..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://captainalan.github.io/pelican-test/">Alan's Miscellaneous Stuff Blog</a></h1>
                <nav><ul>
                    <li><a href="https://captainalan.github.io/pelican-test/category/fun.html">Fun</a></li>
                    <li><a href="https://captainalan.github.io/pelican-test/category/interwebs.html">Interwebs</a></li>
                    <li><a href="https://captainalan.github.io/pelican-test/category/lifestyle.html">Lifestyle</a></li>
                    <li class="active"><a href="https://captainalan.github.io/pelican-test/category/linux.html">Linux</a></li>
                    <li><a href="https://captainalan.github.io/pelican-test/category/news.html">News</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://captainalan.github.io/pelican-test/arch-linux-install-for-n00bs.html" rel="bookmark"
           title="Permalink to Arch Linux Install for n00bs">Arch Linux Install for n00bs</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-06-02T00:00:00-07:00">
                Published: Sun 02 June 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://captainalan.github.io/pelican-test/author/alan-wong.html">Alan Wong</a>
        </address>
<p>In <a href="https://captainalan.github.io/pelican-test/category/linux.html">Linux</a>.</p>

</footer><!-- /.post-info -->      <p>(Last updated February 14, 2021)</p>
<p>In this tutorial, I will go through installing Arch Linux. These
instructions were tried out on both a virtual machine and an old
laptop. For further instructions and details, I recommend <em>resisting
the urge to reflexively search everything</em>, and instead taking the
time to read through high-quality resources, such as the (official)
Arch Wiki <a href="https://wiki.archlinux.org/index.php/Installation_guide">installation
guide</a>.  That
being said, the content in this article should be sufficient to get an
Arch System up and running&em;I've used it multiple times to help me
setup new systems.</p>
<p>I am closely following <a href="https://www.youtube.com/watch?v=4PBqpX0_UOc">Full Arch Linux Install (SAVAGE Edition!)
Linux</a> by Luke Smith (March 8,
2018).</p>
<p>We will do a base installation of Arch Linux. Then we'll run <a href="https://lukesmith.xyz">Luke
Smith's</a> <a href="https://larbs.xyz/">LARBS</a> script to
get an awesome i3 tiling window manager setup from the outset.  (TODO:
Also -&gt; Add instructions/links to a <strong>NEW</strong> tutorial about getting a
Desktop Environment, emacs, etc. and choosing a different path).</p>
<h2>Prerequisites</h2>
<p>This tutorial is aimed at people with some exposure to Linux and/or command
line tools (e.g. using <code>brew</code> under MacOS), but who would like to gain
greater control of their current computing setups. Here, I honor the maxim
that <em>knowledge is power</em> and seek to empower you by getting you started
using Arch Linux and understanding the tools that you are using.</p>
<p>You should know how to do basic things with <code>vi</code> (or <code>vim</code>, or some
other editor readily available in the
<a href="https://en.wikipedia.org/wiki/Computer_terminal#Text_terminals">TTY</a>,
such as <code>nano</code>) because doing an Arch install will involve editing
some text files on the command line.</p>
<h2>Installation Medium</h2>
<p>Download the latest Arch linux ISO. The easiest thing to do is probably to
download from an HTTP mirror near your (physical) location and then install by
CD, DVD, or USB.</p>
<p>From Windows, creating your installation medium is easy. Right click
on the downloaded <code>.iso</code> file and select "Burn disc image" to create
CD or DVD to create a your installation medium. Alternatively, you can
use <a href="https://rufus.ie/">Rufus</a> on Windows to create install media on
USB drives, SD cards, and more.</p>
<h2>Booting with the installation medium</h2>
<p>Restart your computer. You may have to go into your system BIOS to make sure you can boot from your installation medium.</p>
<h3>Get an internet connection</h3>
<p>If you are already connected to the Internet via an ethernet cable, there is
nothing to think about. </p>
<p>If you are connecting via Wi-Fi, there may be some more steps to take. <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>
First, run <code>iwctl</code> see <a href="https://wiki.archlinux.org/index.php/Iwd">ArchWiki</a> for
mroe specifics. Find your wireless card. You may have to scan for networks
multiple times.</p>
<h3>Time and date stuff</h3>
<p>Run <code>timedatectl set-ntp true</code>.</p>
<p>Note the 'prefix' <em>-ctl</em> in the command above. Commands with <em>-ctl</em>
have to do with <em>controlling</em> system processes. A command we will see
later is
<a href="https://wiki.archlinux.org/index.php/Systemd#Basic_systemctl_usage"><code>systemctl</code></a>.</p>
<h2>Partitioning your drive(s)</h2>
<p>Now, let's partition our disks. <strong>Note</strong>: I am assuming you are
installing Arch Linux on a computer you are OK with deleting all data
on. Go reboot and back up your files and stuff if you are not ready to
proceed yet.</p>
<p>In any case you can, run <code>lsblk</code> (or <code>fdisk -l</code>) to "list all block
devices".</p>
<h3>Creating new partitions</h3>
<p>From <code>lsblk</code>, you can identify the drive you want to install Arch Linux on.
This will probably be <code>/dev/sda</code> if you are installing onto an old computer.</p>
<p>Let's start changing things.  To begin, type <code>fdisk /dev/sda</code>, where
'"<code>sda</code>" corresponds to the <strong>drive</strong> you wish to create a new
partition table on (don't do <code>fdisk /dev/sda123</code>; this won't
work&em;go ahead and try that if you don't believe me!).</p>
<p>You will now be sent to a new prompt that looks something like:</p>
<div class="highlight"><pre><span></span><code><span class="nv">Command</span> <span class="ss">(</span><span class="nv">m</span> <span class="k">for</span> <span class="nv">help</span><span class="ss">)</span>:
</code></pre></div>

<p>If there are existing partitions you may need to type <code>d</code> to delete them.
Type <code>p</code> to print partitions. Once you are done deleting existing stuff, type
<code>n</code> at the prompt to make a new partition.</p>
<p>We will now create the following partitions:</p>
<ul>
<li>Boot partition (200MB)</li>
<li>SWAP partition (how much RAM you have, times 1.5)</li>
<li>Root (25 GB or more)</li>
<li>Home (everything else)</li>
</ul>
<p>After typing <code>n</code>, you will be be prompted with a number of options. To create
the Boot partition, accept the first default option (<code>p</code>) to create a new
primary partition. Accept <code>1</code> as the default partition number. Accept the
default "First sector" location. For the "Last sector", enter <code>+200M</code>. This means will be the <em>boot</em> partition which we are allocating 200 MB for.</p>
<p>Next, we will create a <strong>swap partition</strong>. Type <code>n</code> again to get started.
Standard practice is to create a swap partition of about 1.5-2 times the
amount of RAM you have. I'll be using 4 GB for this. Accept the default
partion number (probably 2), default first sector, and for the last sector do
<code>+4G</code> (where you replace "4" with however much memory you select for your
swap partition).</p>
<p>We will now create a <strong>root partition</strong> where all your programs will be
installed. A reasonable starting size for this is around 25 GB, though you
may need more if you like to install a lot of programs. I'll be using 64 GB.
Typing <code>n</code> (and then pressing Enter), I accept the default for the partiton
number and the starting sector and then select <code>+64G</code> for the last sector.</p>
<p>Finally, we need to create a <strong>home partition</strong> which will take up the rest
of your disk. Do <code>n</code> for a new partition and then selct <code>p</code> (rather than <code>e</code>)
to create a new primary partition. Then, accept all the defaults that follow.</p>
<p>We have now created four nice partitions using <code>fdisk</code>. However, these are
not "commited" to disk yet. Write <code>w</code> at the <code>Command (m for help):</code> prompt
to write your partitions to your disk. Note that this will wipe everything on the disk.</p>
<p><strong>Note</strong> since we partitioned our disk, you can easily install a different linux distribution if you wanted; just re-write the <code>root</code> partition and all your <code>home</code> files will still be there.</p>
<p>Type <code>lsblk</code> to see how <code>fdisk</code> changed your harddirve.</p>
<h2>Making filesystems</h2>
<p>We just partitioned our disks, but we need to set <strong>filesystems</strong> to our
partitions.</p>
<p>The <code>boot</code>, <code>root</code>, and <code>home</code> partition (<code>sda1</code>, <code>sda3</code>, and <code>sda4</code> if you
have been following the tutorial for) should be formatted to <code>ext4</code>, a Linux
standard.</p>
<p>Do <code>mkfs.ext4 /dev/sda1</code>, <code>mkfs.ext4 /dev/sda3</code>, and <code>mkfs.ext4 /dev/sda4</code> to
set these partitions' filesystems.</p>
<p>Now, for the swap partition do <code>mkswap /dev/sda2</code>.</p>
<h2>Mounting stuff</h2>
<p>Now that we have created partitions with appropriate filesystems, we need to
<strong>mount</strong> things.</p>
<p>First, do <code>mount /dev/sda3 /mnt</code> to mount your root partition.</p>
<p><strong>Note</strong> at any point during this tutorial you may want to run <code>lsblk</code> to see
*how your disks currently look.</p>
<p>Type <code>ls /mnt</code>. You should see something like <code>lost+found</code> there.</p>
<p>Let's make make some new directories to mount stuff. First do
<code>mkdir /mnt/boot</code> create a mount point for our boot partition. Then, run
<code>mount /dev/sda1 /mnt/boot</code> to do the actual mounting.</p>
<p>Finally, do <code>mkdir /mnt/home</code>. Run <code>mount /dev/sda4 /mnt/home</code> to mount your
home partition.</p>
<h2>Installing the base system</h2>
<p>We now have all of our partitions and have mounted these partitions on our
file systems. Mounting allows us to modify the data on these partitions,
which means we can install softare (like Arch Linux!).</p>
<p>Run <code>lsblk</code> to see that all is as it should be.</p>
<h3>The fun starts with <code>pacstrap</code></h3>
<p>Run <code>pacstrap /mnt base base-devel</code> to install the base package and basic
development tools. If you want more things, add them like so to this command.</p>
<p><strong>Update December 8, 2019</strong>: You may want to also install <code>linux</code> and
<code>linux-firmware</code> to make sure the latest Linux kernel and appropriate drivers
respectively are installed. Do this <em>before</em> you install <code>grub</code> (directions
below) or else you may not be able to boot your new installation.</p>
<div class="highlight"><pre><span></span><code>pacstrap /mnt base base-devel linux linux-firmware neovim
</code></pre></div>

<p>Running this command might take a while because it is installing an entire
base system.</p>
<h2>Making an <code>fstab</code> file</h2>
<p>Earlier, we mounted a bunch of partitions manually. An <code>fstab</code> file tells
Linux what to try to load (see <code>etc/fstab</code>). Run <code>genfstab /mnt</code>. This will
generate an <code>fstab</code> file based on how <code>mnt</code> looks. Running this command will
just output a bunch of stuff.</p>
<p>If you made a swap partition earlier and you don't see it here, you should do
<code>swapon /dev/sdaX</code> (replace <code>/dev/sdaX</code> with your swap partition of course). If
you're going to use a <strong>swap file</strong> later, don't worry about this now&mdash;
you can edit things later.</p>
<p>We need to save these things to a file. Run
<code>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code>.</p>
<p>Now Arch Linux will know what goes where.</p>
<h2>Making our installation bootable</h2>
<p>Run <code>arch-chroot /mnt</code> to change our root. This will change our Arch root to
our new <code>/mnt</code> directory! Before, we were running from our installation
medium, now we are running from our actual installation!</p>
<h3>I needs Interwebs</h3>
<p>Let's install some stuff. First, let's install <code>NetworkManager</code> by typing <code>pacman -S networkmanager</code>.</p>
<p>Next, type <code>systemctl enable NetworkManager</code> to start <code>NetworkManager</code>
whenever you log in.</p>
<h3>GRUB Bootloader</h3>
<p>Run <code>pacman -S grub</code> to install GRUB, our bootloader. This is important!</p>
<p>After this finishes, run <code>grub-install --target=i386-pc /dev/sda</code>.</p>
<p>Once this is done, do <code>grub-mkconfig -o /boot/grub/grub.cfg</code> to make a config
file. (This might be done automatically.)</p>
<h3>Setting a password</h3>
<p>Run <code>passwd</code> to set a root password.</p>
<h3>Setting a locale</h3>
<p>Use your text editor (here I use <code>vim</code>) to edit <code>/etc/locale.gen</code>. I do this
with <code>vim /etc/locale.gen</code>. In this huge list of locales I uncommented</p>
<div class="highlight"><pre><span></span><code>#en_US.UTF-8 UTF-8
#en_US ISO-8859-1
</code></pre></div>

<p>to...</p>
<div class="highlight"><pre><span></span><code>en_US.UTF-8 UTF-8
en_US ISO-8859-1
</code></pre></div>

<p>...in order to set my locale. Note, you can set multiple languages. Save and
exit this file.</p>
<p>Next, run <code>locale-gen</code> to read the conf file you just edited and generate a
file.</p>
<p>Let's edit one more file to set our (default) language: <code>vim
/etc/locale.conf</code>. I changed the contents of this file to:</p>
<div class="highlight"><pre><span></span><code>LANG=en_US.UTF-8
</code></pre></div>

<h3>Setting a timezone</h3>
<p>By default, in <code>/etc/localtime</code>, there are a bunch of time zones. We want to
link <code>/usr/share/zoneinfo/</code> with our timezone.</p>
<div class="highlight"><pre><span></span><code>ln -sf /usr/share/zoneinfo/America/Los_Angeles /etc/localtime
</code></pre></div>

<p>...where of course you replace <code>.../America/Los_Angles...</code> with where you are.</p>
<p>If you travel somewhere else, you will rerun the <code>ln...</code> command here to the
timezone of wherever you are going.</p>
<h3>Setting a hostname</h3>
<p>Finally, you need to set a name for your computer. Edit <code>/etc/hostname</code> to
whatever you like. I will do <code>vim /etc/hostname</code> and enter <code>arch-sama</code> for a (weeby) hostname.</p>
<h3>Going back to your installation medium...</h3>
<p>Type <code>exit</code> to go back to your installation medium.</p>
<p>Then, to be safe type <code>umount -R /mnt</code> to unmount your Arch installation (on
your harddrive).</p>
<h3>Reboot!</h3>
<p>Type <code>reboot</code>. Remove your installation medium. You should boot to your new
installation.</p>
<h2>(Optional) LARBS</h2>
<p>Here is the easy part. To get a pretty cool configuration right away, use
Luke Smith's <a href="https://larbs.xyz">LARBS</a> setup.</p>
<p>Booting your new Arch setup, login as <code>root</code>. You'll be prompted for your
password.</p>
<p>Next, run</p>
<div class="highlight"><pre><span></span><code>curl -LO larbs.xyz/larbs.sh  <span class="c1"># Download the script</span>
bash larbs.sh                <span class="c1"># Run the script you just downloaded!</span>
</code></pre></div>

<h3>Logging in</h3>
<p>Login with the username and password you set in LARBS. To modify your system,
you'll probably need to use <code>su</code> and the password you set for root in the
Arch install.</p>
<h3>Troubleshooting LARBS install</h3>
<p>If you aren't connected to the Internet, this step can be a pain in the ass.
Search the Arch Wiki for wisdom.</p>
<p>If you run into issues with <code>xorg</code>, search for answers related to your graphics
card. Using an older (around 2010) laptop with an NVIDIA graphics card, I had
to install the Nouveau drivers.</p>
<h2>Checking your new system out</h2>
<p>Make sure your <code>/etc/fstab</code> came out correctly.</p>
<p>Running <code>htop</code> I found out that my SWAP partition wasn't being used
after following the above steps. Easy way to get SWAP working was to
install gparted (<code>sudo pacman -Syu gparted</code>) and launch that (<code>sudo
gparted</code>), then make sure the swap partiton I created had <code>SWAPON</code>
(find option in menus). You can then <code>sudo swapon --show</code> to see that
things are working correctly.</p>
<h3>Hard Drive Related Troubleshooting</h3>
<h3>Boot issues</h3>
<p>In this article, I used an "old-school" style of partitioning drives, mounting
partitions, etc.  If you are having trouble booting, you may need to go into
your BIOS to make sure you are booting devices in the correct order. You may
also want to check that your <code>/boot</code> directory (mounted to its own partition,
hopefully) is bootable. Look up how to add a boot <strong>flag</strong> to do this. Two ways
are to use the <code>fdisk</code> util introduced at the beginning of this tutorial, or do
get an install for another distro (e.g. Ubuntu) and use the graphical tools
(e.g. gparted) to assist you in doing that.</p>
<h4>Messed up partitons?</h4>
<p>I used the article "<a href="https://www.tecmint.com/move-home-directory-to-new-partition-disk-in-linux/">move your home directory to a new partiton</a>" as a guide. The same approach here can be used for all sorts of directory and partition shuffling.</p>
<p>The basic procedure to move your <code>/home/</code> to a new partition is to</p>
<ol>
<li>create a new partition,</li>
<li>copy your existing <code>/home</code> directory there and verify this operation succeeded,</li>
<li>remove the old files you just copied,</li>
<li>mount the copied files on the correct (new) partition to <code>/home</code></li>
<li>save your configuration in <code>/etc/fstab</code></li>
</ol>
<p>These operations will require <code>su</code> permissions (e.g. through using <code>sudo</code>).</p>
<h2>(Optional) Next Steps</h2>
<ul>
<li>(Add directions for setting up a user, <code>sudo</code> privileges)</li>
<li>(Add directions for getting a window manager; getting some starter fonts)</li>
<li>(Add basic shell setup)</li>
<li>(Add directions for setting up <code>yay</code> or another AUR helper)</li>
</ul>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>(Update February 14, 2021) Formerly, this was easier&mdash;you could just
  run <code>wifi-menu</code>. Now it seems this program isn't available in the installer.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="https://captainalan.github.io/">Homepage</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://captainalan.github.io/pelican-test/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://github.com/captainalan">GitHub</a></li>
                            <li><a href="https://www.linkedin.com/in/alan-wong-bb342569/">Linked In</a></li>
                            <li><a href="https://www.facebook.com/captainalan">Facebook</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>